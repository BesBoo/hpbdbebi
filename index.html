<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <script>
        emailjs.init('hlVOsu7aNJAlx2UKB'); // Thay bằng public key của bạn
    </script>

    <title>Sách Chúc Mừng Sinh Nhật</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family:  'Times New Roman', sans-serif;
            background: linear-gradient(135deg, #fce4ec 0%, #e3f2fd 50%, #ffffff 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
        }

        /* Password Modal */
        .password-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.95);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .password-box {
            background: linear-gradient(145deg, #fff 0%, #f8bbd9 50%, #bbdefb 100%);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            text-align: center;
            border: 2px solid rgba(255, 182, 193, 0.3);
            max-width: 90%;
            width: 400px;
        }

        .password-box h2 {
            color: #ad1457;
            margin-bottom: 20px;
            font-size: clamp(1.5rem, 4vw, 2rem);
        }

        .password-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #f8bbd9;
            border-radius: 10px;
            font-size: 18px;
            text-align: center;
            margin-bottom: 20px;
            background: rgba(255, 255, 255, 0.8);
            outline: none;
            transition: all 0.3s ease;
        }

        .password-input:focus {
            border-color: #1976d2;
            box-shadow: 0 0 15px rgba(25, 118, 210, 0.3);
        }

        .submit-btn {
            background: linear-gradient(45deg, #f8bbd9, #bbdefb);
            color: #ad1457;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        /* Book Container */
        .book-container {
            display: none;
            perspective: 1500px;
            position: relative;
        }

        .book {
            width: 600px;
            height: 400px;
            position: relative;
            transform-style: preserve-3d;
            margin: 50px;
        }

        /* Bìa cuốn sách */
        .book-cover {
            position: absolute;
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 10px;
            border: 3px solid rgb(130, 238, 255);
            box-shadow: 
                0 0 0 2px #ff9be6,
                0 10px 30px rgba(151, 249, 223, 0.5),
                inset 0 2px 10px rgba(142, 227, 248, 0.1);
            transform-origin: left center;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 100;
        }

        .book-cover.open {
            transform: rotateY(-180deg);
        }
        .page-content.hidden {
            visibility: hidden;
        }

        /* trang bên trong */
        .page {
            position: absolute;
            width: 100%;
            height: 100%;
            background: #fefefe;
            border: 1px solid #ddd;
            border-radius: 8px;
            transform-origin: left center;
            transform-style: preserve-3d;
            transition: transform 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            box-shadow: 
                0 2px 10px rgba(0,0,0,0.1),
                inset 0 1px 0 rgba(255,255,255,0.6);
            overflow: hidden;
            backface-visibility: hidden;
        }

        .page::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 20px;
            height: 100%;
            background: linear-gradient(90deg, 
                rgba(255,182,193,0.1) 0%, 
                rgba(255,182,193,0.05) 50%, 
                transparent 100%);
            pointer-events: none;
        }

        .page-content {
            padding: 40px;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            position: relative;
        }

        .page-content h1 {
            color: #ad1457;
            font-size: 2.5rem;
            margin-bottom: 25px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            font-family: 'Times New Roman', sans-serif;
            font-weight: bold;
            width: 100%;
            text-align: center;
        }

        .page-content h2 {
            color: #1976d2;
            font-size: 1.8rem;
            margin-bottom: 20px;
            font-family: 'Times New Roman', sans-serif;
            width: 100%;
            text-align: center;
        }

        .page-content p {
            color: #444;
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 15px;
            max-width: 85%;
            font-family: 'Times New Roman', sans-serif;
            width: 100%;
            text-align: center;
        }

        .flipped {
            transform: rotateY(-180deg);
        }

        .page-number {
            position: absolute;
            bottom: 15px;
            right: 25px;
            color: #ad1457;
            font-size: 1rem;
            opacity: 0.7;
            font-style: italic;
        }

        /* Navigation Arrows */
        .nav-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            width: 50px;
            height: 50px;
            background: rgba(173, 20, 87, 0.8);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 200;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        }

        .nav-arrow:hover {
            background: rgba(173, 20, 87, 1);
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }

        .nav-arrow.disabled {
            opacity: 0.3;
            cursor: not-allowed;
            pointer-events: none;
        }

        .arrow-left {
            left: -70px;
        }

        .arrow-right {
            right: -70px;
        }

        /* Choice buttons for last page */
        .choice-buttons {
            display: flex;
            gap: 20px;
            margin-top: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .choice-btn {
            background: black;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
            min-width: 120px;
        }

        .choice-btn:hover {
            background: green;
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .choice-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
        }

        /* Success message */
        .success-message {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(145deg, #fff 0%, #f8bbd9 50%, #bbdefb 100%);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            text-align: center;
            z-index: 1001;
            max-width: 90%;
        }

        /* Loading spinner */
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #ad1457;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Typing animation */
        .typing-text {
            opacity: 1;
            overflow: hidden;
            white-space: nowrap;
            border-right: 2px solid #ad1457;
            animation: blink-cursor 1s infinite;
            width: 0;
        }

        .typing-text.active {
            animation: typewriter 0.75s steps(40, end) forwards, blink-cursor 1s infinite;
        }

        .typing-text.typing-complete {
            border-right: none;
            animation: none;
            white-space: normal;
            word-wrap: break-word;
            width: auto !important;
            overflow: visible;
        }

        @keyframes typewriter {
            from {
                width: 0;
            }
            to {
                width: 100%;
            }
        }

        @keyframes blink-cursor {
            from, to {
                border-color: transparent;
            }
            50% {
                border-color: #ad1457;
            }
        }

        /* Page curl effect */
        .page-curl {
            position: relative;
            overflow: hidden;
        }

        .page-curl::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 0;
            height: 0;
            background: linear-gradient(225deg, transparent 45%, rgba(0,0,0,0.1) 50%, rgba(0,0,0,0.2) 55%, transparent 100%);
            transition: all 0.3s ease;
        }

        .page-curl.curling::after {
            width: 50px;
            height: 50px;
            border-radius: 0 0 0 50px;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .book {
                width: 90vw;
                height: 60vw;
                margin: 20px;
            }

            .nav-arrow {
                width: 40px;
                height: 40px;
                font-size: 16px;
            }

            .arrow-left {
                left: -50px;
            }

            .arrow-right {
                right: -50px;
            }

            .page-content {
                padding: 20px;
            }

            .page-content h1 {
                font-size: 2rem;
            }

            .page-content h2 {
                font-size: 1.5rem;
            }

            .page-content p {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- Password Modal -->
    <div class="password-modal" id="passwordModal">
        <div class="password-box">
            <h2>🎂 Nhập Mật Khẩu 🎂</h2>
            <input type="text" class="password-input" id="passwordInput" placeholder="Nhập mật khẩu...">
            <button class="submit-btn" onclick="checkPassword()">Xác Nhận</button>
        </div>
    </div>

    <!-- Book Container -->
    <div class="book-container" id="bookContainer">
        <div class="book" id="book">
            <!-- Navigation Arrows -->
            <button class="nav-arrow arrow-left disabled" id="leftArrow" onclick="previousPage()">
                &#8249;
            </button>
            <button class="nav-arrow arrow-right" id="rightArrow" onclick="nextPage()">
                &#8250;
            </button>

            <!-- Book Cover -->
            <div class="book-cover" id="bookCover">
                <div class="page-content">
                    <h1> Chúc Mừng Sinh Nhật</h1>
                    <p>🎉Bé bi thúi🎉</p>
                    <p> Click mũi thên bên phải để mở sách nho</p>

                </div>
            </div>

            <!-- Pages -->
            <div class="page" data-page="1" style="z-index: 10;">
                <div class="page-content">
                    <h1 class="typing-text">🎉 Chúc Mừng Sinh Nhật! 🎉</h1>
                    <p class="typing-text">Cuốn sách nhỏ này dành riêng cho bạn</p>
                    <p class="typing-text">Chúc bạn có một ngày sinh nhật thật đặc biệt!</p>
                    <div class="page-number">1/9</div>
                </div>
            </div>

            <div class="page" data-page="2" style="z-index: 9;">
                <div class="page-content">
                    <h2 class="typing-text">💝 Lời Chúc Đầu Tiên</h2>
                    <p class="typing-text">Mong rằng tuổi mới sẽ mang đến cho bạn nhiều niềm vui, hạnh phúc và thành công.</p>
                    <p class="typing-text">Bạn xứng đáng nhận được tất cả những điều tốt đẹp nhất!</p>
                    <div class="page-number">2/9</div>
                </div>
            </div>

            <div class="page" data-page="3" style="z-index: 8;">
                <div class="page-content">
                    <h2 class="typing-text">🌟 Ước Mơ Và Hi Vọng</h2>
                    <p class="typing-text">Chúc tất cả những ước mơ của bạn sẽ trở thành hiện thực!</p>
                    <p class="typing-text">Mong bạn luôn tự tin và mạnh mẽ trên con đường phía trước.</p>
                    <div class="page-number">3/9</div>
                </div>
            </div>

            <div class="page" data-page="4" style="z-index: 7;">
                <div class="page-content">
                    <h2 class="typing-text">❤️ Tình Yêu Và Tình Bạn</h2>
                    <p class="typing-text">Chúc bạn được bao quanh bởi tình yêu thương của gia đình và bạn bè.</p>
                    <p class="typing-text">Những người thân yêu sẽ luôn ở bên cạnh bạn trong mọi khoảnh khắc.</p>
                    <div class="page-number">4/9</div>
                </div>
            </div>

            <div class="page" data-page="5" style="z-index: 6;">
                <div class="page-content">
                    <h2 class="typing-text">🍀 May Mắn Và Thành Công</h2>
                    <p class="typing-text">Chúc bạn gặp nhiều may mắn trong công việc và cuộc sống!</p>
                    <p class="typing-text">Mọi nỗ lực của bạn sẽ được đền đáp xứng đáng.</p>
                    <div class="page-number">5/9</div>
                </div>
            </div>

            <div class="page" data-page="6" style="z-index: 5;">
                <div class="page-content">
                    <h2 class="typing-text">☀️ Ánh Sáng Và Năng Lượng</h2>
                    <p class="typing-text">Chúc bạn luôn tràn đầy năng lượng tích cực!</p>
                    <p class="typing-text">Nụ cười của bạn sẽ là ánh sáng sưởi ấm trái tim mọi người xung quanh.</p>
                    <div class="page-number">6/9</div>
                </div>
            </div>

            <div class="page" data-page="7" style="z-index: 4;">
                <div class="page-content">
                    <h2 class="typing-text">🌈 Màu Sắc Cuộc Sống</h2>
                    <p class="typing-text">Chúc cuộc sống của bạn luôn rực rỡ như cầu vồng!</p>
                    <p class="typing-text">Mỗi ngày mới sẽ mang đến những trải nghiệm thú vị và bất ngờ.</p>
                    <div class="page-number">7/9</div>
                </div>
            </div>

            <div class="page" data-page="8" style="z-index: 3;">
                <div class="page-content">
                    <h2 class="typing-text">🌸 Tuổi Mới Tươi Đẹp</h2>
                    <p class="typing-text">Chúc tuổi mới của bạn nở rộ như những bông hoa xuân!</p>
                    <p class="typing-text">Bạn sẽ ngày càng xinh đẹp, trưởng thành và hoàn thiện bản thân.</p>
                    <div class="page-number">8/9</div>
                </div>
            </div>

            <div class="page" data-page="9" style="z-index: 2;">
                <div class="page-content">
                    <h2 class="typing-text">🎊 Lời Chúc Cuối Cùng</h2>
                    <p class="typing-text">Cảm ơn bạn đã đọc hết cuốn sách nhỏ này!</p>
                    <p class="typing-text">Hãy chọn một trong hai nút bên dưới để gửi phản hồi nhé!</p>
                    <div class="choice-buttons">
                        <button class="choice-btn" onclick="sendChoice('jopi', event)">Jopi</button>
                        <button class="choice-btn" onclick="sendChoice('doki', event)">đi chụp hình, sau đó đi ăn doki</button>
                    </div>
                    <div class="page-number">9/9</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Success Message -->
    <div class="success-message" id="successMessage">
        <h2> Cảm ơn bé bi ❤ </h2>
        <p>Anh bic ngay bé sẽ chọn này mà hihi</p>
    </div>

    <script>
        function normalizeTextContent() {
            document.querySelectorAll('*').forEach(el => {
                if (el.childNodes.length === 1 && el.childNodes[0].nodeType === 3) {
                    el.textContent = el.textContent.normalize("NFC");
                }
            });
        }

        window.addEventListener("DOMContentLoaded", normalizeTextContent);
        let currentPage = 0; // 0 = closed, 1-9 = pages
        const totalPages = 9;
        let pages = [];
        let bookCover;
        let leftArrow, rightArrow;
        let typingAnimationInProgress = false;
        let typedPages = new Set(); // Track which pages have been typed

        function checkPassword() {
            const password = document.getElementById('passwordInput').value;
            if (password === '1008') {
                document.getElementById('passwordModal').style.display = 'none';
                document.getElementById('bookContainer').style.display = 'block';
                initializeBook();
            } else {
                alert('Mật khẩu không đúng! Vui lòng thử lại.');
                document.getElementById('passwordInput').value = '';
            }
        }

        function initializeBook() {
            pages = document.querySelectorAll('.page');
            bookCover = document.getElementById('bookCover');
            leftArrow = document.getElementById('leftArrow');
            rightArrow = document.getElementById('rightArrow');
            
            // Hide all pages initially
            pages.forEach(page => {
                page.style.display = 'none';
            });
            
            updateArrows();
        }

        function updateArrows() {
            // Left arrow: disabled when book is closed (page 0)
            if (currentPage === 0) {
                leftArrow.classList.add('disabled');
            } else {
                leftArrow.classList.remove('disabled');
            }

            // Right arrow: disabled when on last page
            if (currentPage === totalPages) {
                rightArrow.classList.add('disabled');
            } else {
                rightArrow.classList.remove('disabled');
            }
        }
        

        function nextPage() {
            if (typingAnimationInProgress || currentPage >= totalPages) return;

            if (currentPage === 0) {
                // Ẩn nội dung trang bìa khi mở sách
                const coverContent = bookCover.querySelector('.page-content');
                if (coverContent) coverContent.classList.add('hidden');

                // Mở sách
                bookCover.classList.add('open');
                currentPage = 1;
                showPage(1);


            } else if (currentPage < totalPages) {
                const prevPageElement = pages[currentPage - 1];
                const prevContent = prevPageElement.querySelector('.page-content');
                if (prevContent) prevContent.classList.add('hidden'); // Ẩn nội dung trước

                prevPageElement.classList.add('flipped');
                currentPage++;
                if (currentPage <= totalPages) {
                    showPage(currentPage);
                }
            }

            updateArrows();
        }


        function previousPage() {
            if (typingAnimationInProgress || currentPage <= 0) return;

            if (currentPage === 1) {
                 // Hiện lại nội dung trang bìa khi đóng sách
                const coverContent = bookCover.querySelector('.page-content');
                if (coverContent) coverContent.classList.remove('hidden');

                // Đóng sách
                bookCover.classList.remove('open');
                hidePage(1);
                currentPage = 0;
            } else if (currentPage > 1) {
                hidePage(currentPage);
                currentPage--;
                const pageElement = pages[currentPage - 1];
                pageElement.classList.remove('flipped');

                const content = pageElement.querySelector('.page-content');
                if (content) content.classList.remove('hidden'); // Hiện lại nội dung khi lật ngược
            }

            updateArrows();
        }


        function showPage(pageNum) {
            const page = pages[pageNum - 1];
            page.style.display = 'block';

            const content = page.querySelector('.page-content');
            if (content) content.classList.remove('hidden'); // Hiện lại nếu cần

            if (!typedPages.has(pageNum)) {
                startTypingAnimation(page, pageNum);
            }
        }


        function hidePage(pageNum) {
            const page = pages[pageNum - 1];
            page.style.display = 'none';
        }

        function startTypingAnimation(page, pageNum) {
            typingAnimationInProgress = true;
            const typingElements = page.querySelectorAll('.typing-text');
            let index = 0;

            // Reset all text elements
            typingElements.forEach(el => {
                el.classList.remove('active', 'typing-complete');
                el.style.width = '0';
            });

            // Gõ từng dòng tuần tự
            function typeNext() {
                if (index >= typingElements.length) {
                    typingAnimationInProgress = false;
                    typedPages.add(pageNum);
                    return;
                }

                const el = typingElements[index];
                el.classList.add('active');

                // Tính thời gian typing dựa trên chiều dài nội dung (hoặc cố định như cũ)
                const typingDuration = 1500;

                setTimeout(() => {
                    el.classList.remove('active');
                    el.classList.add('typing-complete');
                    index++;
                    typeNext(); // Gọi dòng tiếp theo
                }, typingDuration);
            }

            typeNext(); // Bắt đầu gõ dòng đầu tiên
        }


        async function sendChoice(choice, event) {
            const clickedBtn = event.target;
            const buttons = document.querySelectorAll('.choice-btn');

            const originalText = clickedBtn.innerText.trim();

            clickedBtn.disabled = true;
            clickedBtn.innerHTML = '<div class="spinner"></div>Đang gửi...';

            buttons.forEach(btn => {
                if (btn !== clickedBtn) btn.disabled = true;
            });

            const messageText = `Lịch trình hôm nay: ${originalText}\n\nĐi đón bé bi thúi thôi nào!`;

            try {
                const result = await emailjs.send('service_mzf7g9r', 'template_tg1i71h', {
                    subject: 'Plan bé bi đã chọn 🎉',
                    message: messageText
                });

                console.log('EmailJS response:', result);

                const successBox = document.getElementById('successMessage');
                const message = originalText;
                successBox.innerHTML = `
                    
                    <p>Anh bic em sẽ chọn này mà</p>
                    
                `;
                successBox.style.display = 'block';

                document.querySelector('.choice-buttons').style.display = 'none';
                setTimeout(() => {
                    successBox.style.display = 'none';
                }, 4000);

            } catch (error) {
                console.error('Lỗi khi gửi bằng EmailJS:', error);

                const successBox = document.getElementById('successMessage');
                successBox.innerHTML = `
                    <h2>❌ Có lỗi xảy ra</h2>
                    <p>Anh hong nhận được thông tin ròi hic hic</p>
                    <p style="font-size: 0.9rem; color: #666; margin-top: 10px;">${error.text || error.message}</p>
                `;
                successBox.style.display = 'block';

                setTimeout(() => {
                    successBox.style.display = 'none';
                    buttons.forEach((btn, index) => {
                        btn.disabled = false;
                        btn.innerHTML = index === 0 ? 'Jopi' : 'Doki';
                    });
                }, 4000);
            }
        }



        // Keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (document.getElementById('bookContainer').style.display === 'block') {
                if (e.key === 'ArrowRight' || e.key === ' ') {
                    nextPage();
                } else if (e.key === 'ArrowLeft') {
                    previousPage();
                }
            }
        });

        // Enter key for password
        document.getElementById('passwordInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                checkPassword();
            }
        });
    </script>
</body>
</html>
